<!DOCTYPE html>
<html lang="en">

<!-- trait tracker results -->

    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
            integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <link rel="stylesheet" href="css/function.css">
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
        <title>SpotifyU</title>
    </head>
    
    <body>
        <header>
            <img class="logo" img style="height:50px" src="images/spotifyu.png" alt="SpotifyU">
            <nav>
                <ul class="nav_links">
                    <li><a href="home">Home</a></li>
                    <li><a href="#">About</a></li>
                    <li><a href="search">Search</a></li>
                </ul>
            </nav>
        </header>

    <!-- description  -->
    <section>
    <div class="containerTop">
        <div class="intro">
            <h1>Trait Tracker Results</h1>
        </div>
    </div>
    </section>

    <!-- search bar  -->
    <div class="searchContainer">
        <form action="tt-searchAdd" class="d-flex" method="POST">
            <!-- {% csrf_token %} -->
            <select name="selection" id="dropdown">
                <option value="song">Song</option>
                <option value="artist">Artist</option>
            </select>
            <input class="form-control me-2" type="text" placeholder="Enter a song here" aria-label="Search"
                name="searchbar">
            <button class="btn btn-outline-secondary" type="submit">Search</button>
        </form>
    </div>

    <!-- search results-->
    <div class="resultsChart">
        <div id="search-results" class="row">
            <table>
                <tr>
                    <% for (var i=0; i < selectSongs.length; i++) { %>
                        <td>
                            <div class="showResults songCSS" id="0">
                                <span class="songCSS">
                                    <%= selectSongs[i]%>
                                </span>
                                <form action="tt-update" method="POST">
                                    <input type="hidden" name="ID" value="<%= selectSongID[i]%>"></input>
                                    <input type="submit" id="btn<%=  i%>" value="Update"></input>
                                </form>
                                <form action="trait-tracker" method="POST">
                                    <input type="hidden" name="songToDelete" value="<%=  selectSongs[i]%>" readonly>
                                    <input type="submit" value="Delete">
                                </form>
                            </div>
                        </td>
                        <% } %>
                </tr>
            </table>
        </div>
    </div>


    <div>
        <canvas id="stddevchart" width="200" height="200"></canvas>
        <form action="tt-results" method="POST">
            <input type="submit" value="Regenerate">
        </form>
    </div>
    <script>
        var resultsList = <%- JSON.stringify(results) %>;
        const ctx = document.getElementById('stddevchart').getContext('2d');
        const myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Danceability', 'Energy', 'Speechiness', 'Acousticness', 'Instrumentalness', 'Liveness', 'Valence'],
                datasets: [{
                    label: 'Standard Deviation',
                    data: resultsList,
                    backgroundColor: [
                        'rgba(50, 205, 48, 0.4)',
                        'rgba(44, 94, 26, 0.4)',
                        'rgba(148, 201, 115, 0.4)',
                        'rgba(26, 67, 20, 0.4)',
                        'rgba(178, 210, 164, 0.4)',
                        'rgba(50, 205, 48, 0.4)',
                        'rgba(44, 94, 26, 0.4)'
                    ],
                    borderColor: [
                        'rgba(50, 205, 48, 1)',
                        'rgba(44, 94, 26, 1)',
                        'rgba(148, 201, 115, 1)',
                        'rgba(26, 67, 20, 1)',
                        'rgba(178, 210, 164, 1)',
                        'rgba(50, 205, 48, 0.4)',
                        'rgba(44, 94, 26, 0.4)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>
    </body>
</html>